function parseSendObjs(e){}function getBindCFComponent(e){return $('[bind-componentid="'+e+'"]')}function applyBindableResponseToNodeChildren(e,t){var n=0;if("true"==e.SELF)var o=$(t).children(e.SELECTOR);else{var a=$(t).children(":not([bind-componentid])");for(childNode of a)n=+applyBindableResponseToNodeChildren(e,childNode);o=$(t).children(e.SELECTOR)}var d="";for(d of o){var r=$(d);if(r.is(e.SELECTOR)||"true"==e.SELF)switch(e.ACTION.toLowerCase()){case"call":window[e.NAME]($bind.getVarOrJSON(e.DATA)),rebindNodeEvents(r);break;case"replace":r.html(e.VALUE),rebindNodeEvents(r);break;case"append":r.append(e.VALUE),rebindNodeEvents($(r));break;case"prepend":r.prepend(e.VALUE),rebindNodeEvents($(r));break;case"remove":r.remove();break;case"hide":r.hide();break;case"show":o.show();break;case"toggle":r.toggle();break;case"fadeout":r.fadeOut(e.VALUE);break;case"fadein":r.fadeIn(e.VALUE);break;case"setvalue":r.val(e.VALUE);break;case"addclass":r.addClass(e.VALUE);break;case"removeclass":r.removeClass(e.VALUE);break;case"replaceclass":r.removeClass(e.OLDVALUE),r.addClass(e.VALUE);break;case"setattr":r.prop(e.ATTRNAME,e.VALUE);break;case"removeattr":r.removeAttr(e.ATTRNAME);break;case"addbindevent":var i=r.attr("bind-events");r.attr("bind-events",i+" "+e.VALUE);break;case"removebindevent":i=r.attr("bind-events");r.attr("bind-events",i.replace(new RegExp("(?:^|\\s)"+e.VALUE+"(?:\\s|$)")," "));break;case"replacebindevent":i=r.attr("bind-events");r.attr("bind-events",i.replace(new RegExp("(?:^|\\s)"+e.OLDVALUE+"(?:\\s|$)")," ")),i=r.attr("bind-events"),r.attr("bind-events",i+" "+e.VALUE);break;case"faderemove":r.fadeOut(parseInt(e.TIME),(function(){$(this).remove()}));break;case"fadeappend":r.append($(e.VALUE).hide().fadeIn(e.TIME)),rebindNodeEvents(r);break;case"fadeprepend":r.prepend($(e.VALUE).hide().fadeIn(e.TIME)),rebindNodeEvents(r);break;case"fadereplace":r.html($(e.VALUE).hide().fadeIn(e.TIME)),rebindNodeEvents(r);break;case"add":r.add($(e.VALUE.trim())),rebindNodeEvents(r)}}return n}function bindCFLog(e,t){}function handleBindableResponse(e){for(task of(console.log(e),$bind.setModelByComponentId(e.BIND_RESPONSE.MODEL.componentid,e.BIND_RESPONSE.MODEL),e.updatedChildren=0,e.BIND_RESPONSE.TASKS))"dipatch"!=task.ACTION.toLowerCase()&&"publish"!=task.ACTION.toLowerCase()&&(e.updatedChildren+=applyBindableResponseToNodeChildren(task,getBindCFComponent(task.COMPONENTID)));for(task of(udpatedChildren=0,e.BIND_RESPONSE.TASKS))if("dispatch"==task.ACTION.toLowerCase()||"publish"==task.ACTION.toLowerCase()||"broadcast"==task.ACTION.toLowerCase()){var t=$('[bind-componentid="'+task.COMPONENTID+'"]');if("dispatch"==task.ACTION.toLowerCase())var n=t.closest('[bind-events~="'+task.TYPE+'"]');if("publish"==task.ACTION.toLowerCase())n=t.find('[bind-events~="'+task.TYPE+'"]');if("broadcast"==task.ACTION.toLowerCase())n=$('[bind-events~="'+task.TYPE+'"]');if(n&&0!=n.length)for(listener of n){listener=$(listener);var o={type:task.ACTION.toLowerCase(),data:{id:listener.attr("id"),action:task.ACTION.toLowerCase(),type:task.TYPE,value:task.VALUE,formdata:$bind.getComponentForm(listener),key:listener.attr("key"),attrs:getAttributesCollection(listener),tagname:listener[0].tagName.toLowerCase(),componentid:$bind.getComponentId(listener),formdata:$bind.getComponentForm(listener),data:task.DATA,bodyComponentId:$bind.getBodyComponentId(),model:$bind.getModelByNode(listener),dispatcherdata:{type:task.TYPE,data:{id:listener.attr("id"),action:task.ACTION.toLowerCase(),value:task.VALUE,formdata:$bind.getComponentForm(t),key:t.attr("key"),attrs:getAttributesCollection(t),tagname:t[0].tagName.toLowerCase(),componentid:$bind.getComponentId(t),formdata:$bind.getComponentForm(t),data:task.DATA,bodyComponentId:$bind.getBodyComponentId(),model:$bind.getModelByNode(t)}}}},a=$(listener).children().first().parents("[bind-handler]").first().attr("bind-handler");$.ajax({url:a,type:"POST",data:"BINDFRAMEWORK_DATA="+JSON.stringify(o),success:function(e){handleBindableResponse("object"==typeof e?e:JSON.parse(e))}})}else console.log("could not find a listener/subscriber component for "+task.ACTION.toLowerCase()+":"+task.TYPE+".  check that you have a bind-component with this type.  NOTE: possible values for the attributes bind-listens should be SPACE DELIMITED")}}function getAttributesCollection(e){var t=[];return $(e).each((function(){$.each(this.attributes,(function(){this.specified&&t.push({name:this.name,value:this.value})}))})),t}function handleBindableCFEvent(e){console.log("bindable event triggered:"),console.log(e),payload={type:"handleEvent",data:{id:$(e.currentTarget).attr("id"),type:e.type,formdata:$bind.getComponentForm(e.currentTarget),key:$(e.currentTarget).attr("key"),attrs:getAttributesCollection($(e.currentTarget)),tagname:e.currentTarget.tagName.toLowerCase(),componentid:$(e.currentTarget).parents("[bind-componentid]").first().attr("bind-componentid"),bodyComponentId:$bind.getBodyComponentId(),model:$bind.getModelByNode(e.currentTarget)}},console.log("payload"),console.log(payload);var t=$(e.currentTarget).parents("[bind-handler]").first().attr("bind-handler");$.ajax({url:t,type:"POST",data:"BINDFRAMEWORK_DATA="+JSON.stringify(payload),success:function(e){handleBindableResponse("object"==typeof e?e:JSON.parse(e))}})}var $bind={models:[],getComponentById:e=>$('[bind-componentid="'+e+'"]'),getMyParentComponent(e){return $(this.getMyComponent(e)).parents("[bind-componentid]").first()},getMyComponent:e=>$(e).attr("bind-componentid")?$(e):$(e).parents("[bind-componentid]").first(),getVarOrJSON:function(e){try{return JSON.parse(e)}catch(t){return e}},getComponentId:function(e){return this.getMyComponent(e).attr("bind-componentid")},getModelByNode:function(e){return this.getModelByComponentId(this.getComponentId(e))},getModelByComponentId:function(e){return this.models[e]||(this.models[e]={componentid:e,data:{}}),this.models[e]},setModelByComponentId:function(e,t){return this.models[e]||(this.models[e]={componentid:e,data:{}}),this.models[e]=t,this.models[e]},getBodyComponentId:function(){return this.bodyComponentId||(this.bodyComponentId=$("body").attr("bind-componentid")),this.bodyComponentId},setFormDataObjElement:function(e,t,n,o){for(var a=0;a<e.forms.length;a++)if(e.forms[a].name==t)return e.forms[a].fields[n]&&e.forms[a].fields[n].length>0?e.forms[a].fields[n]=e.forms[a].fields[n].split(",").concat([o]).join(","):e.forms[a].fields[n]=o,e;return e.forms[e.forms.length]={name:t,fields:{}},e.forms[e.forms.length-1].fields[n]=o,e},getComponentForm:function(e){var t=this.getMyComponent(e);return this.getFormDataForChildren(t,{forms:[{name:"_noFormName",fields:{}}]})},getFormDataForChildren:function(e,t){var n="",o=$(e).children("input");for(d of o){n=0==(d=$(d)).closest("form[name]").length?"_noFormName":d.closest("form[name]").attr("name"),("checkbox"!=d.attr("type")&&"radio"!=d.attr("type")||"checkbox"==d.attr("type")&&d[0].checked)&&(t=this.setFormDataObjElement(t,n,d.attr("name"),d.val())),"radio"==d.attr("type")&&d[0].checked&&(t=this.setFormDataObjElement(t,n,d.attr("name"),d.val()))}for(d of o=$(e).children("select")){var a="";n=0==(d=$(d)).closest("form[name]").length?"_noFormName":d.closest("form[name]").attr("name"),a=d.attr("multiple")?d.val().join(","):d.val(),t=this.setFormDataObjElement(t,n,d.attr("name"),a)}for(d of o=$(e).children("textarea")){var d;n=0==(d=$(d)).closest("form[name]").length?"_noFormName":d.closest("form[name]").attr("name"),t=this.setFormDataObjElement(t,n,d.attr("name"),d.val())}var r=$(e).children(":not([bind-component])");for(child of r)t=this.getFormDataForChildren(child,t);return t}};function processComponentLoadingForNode(e){var t=$("[bind-load]");for(nodeToLoad of t)nodeToLoad=$(nodeToLoad),"1"!=nodeToLoad.attr("bind-loaded")&&"1"!=nodeToLoad.attr("bind-loading")&&(nodeToLoad.attr("bind-loading",1),console.log(nodeToLoad.attr("bind-componentid")+" loading: "+nodeToLoad.attr("bind-load")),$.ajax({url:nodeToLoad.attr("bind-load"),type:"POST",data:"BINDFRAMEWORK_DATA=",componentid:nodeToLoad.attr("bind-componentid"),success:function(e){var t=$('[bind-componentid="'+this.componentid+'"]');t.html(e),t.attr("bind-loading","0"),t.attr("bind-loaded","1"),console.log(this.componentid+" loaded: "+this.url),rebindNodeEvents(t),dispatchComponentReady(t)}}))}function dispatchComponentReady(e){var t=$("body").attr("bind-handler"),n=$(e).attr("bind-componentid");"body"==e[0].tagName.toLowerCase()?t&&0!=t.trim().length||(t="#",$("body").attr("bind-handler",t)):(t=e.attr("bind-handler"))||(t=$(e).parents("[bind-handler]").first().attr("bind-handler"));var o={type:"ready",data:{id:$(e).attr("id"),key:$(e).attr("key"),type:"ready",attrs:getAttributesCollection($(e)),tagname:$(e)[0].tagName.toLowerCase(),componentid:n,bodyComponentId:$bind.getBodyComponentId(),model:$bind.getModelByNode(e)}};$.ajax({url:t,type:"POST",data:"BINDFRAMEWORK_DATA="+JSON.stringify(o),success:function(e){handleBindableResponse("object"==typeof e?e:JSON.parse(e))}})}function rebindNodeEvents(e){$(e).find("[bind-load]").map(((e,t)=>{$(t).attr("bind-component",!0)})),$(e).find("[bind-handler]").map(((e,t)=>{$(t).attr("bind-component",!0)})),$(e).find('[bind-component="true"]').map(((e,t)=>{let n=$(t).attr("bind-componentid");n&&0!=n.length||$(t).attr("bind-componentid",createBindCFUUIDName())})),$(e).find('[bind-componentid=""]').map(((e,t)=>{$(t).attr("bind-componentid",createBindCFUUIDName())})),processComponentLoadingForNode(e),$(e).find("[bind-events]").map(((e,t)=>{eventTypes=$(t).attr("bind-events"),eventTypes.split(" ").map((e=>{e=e.trim(),$(t).unbind(e+".bindCF").bind(e+".bindCF",handleBindableCFEvent)}))}))}function uuidv4NoDashes(){return"10000000100040008000100000000000".replace(/[018]/g,(e=>(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)))}function createBindCFUUIDName(){return"bind_"+uuidv4NoDashes()}$("document").ready((function(){$("body").attr("bind-component")||$("body").attr("bind-component","true"),$("body").attr("bind-componentid")||$("body").attr("bind-componentid",createBindCFUUIDName()),rebindNodeEvents($("body")),dispatchComponentReady($("body"))}));